---
- summary: |
    Проверка успешной регистрации нового пользователя
  requirement: |
    При вводе валидной почты, никнейма и пароля пользователь должен зарегистрироваться в системе
  prerequisites: |
    Нет
  test-data: |
    Nickname = testuser2, email = testuser@example.com, password = admin123.
  steps:
    1. Открыть страницу регистрации
    2. Ввести тестовые данные в поля Nickname, Email, Password, Password Confirmation
    3. Нажать кнопку Submit
  expected-result: |
    Пользователь зарегистрирован и перенаправлен на главную страницу сайта

- summary: |
    Проверка неуспешной регистрации с некорректным email
  requirement: |
    При вводе некорректной почты пользователь не должен зарегистрироваться
  prerequisites:
    Нет
  test-data: |
    Nickname = testuser3, email = testuser@example, password = admin123.
  steps:
    1. Ввести некорректный email
    2. Ввести валидный пароль
    3. Нажать кнопку Submit
  expected-result: |
    Регистрация не проходит, появляется сообщение "Invalid email"

- summary: |
    Проверка успешного входа через через OAuth-интеграцию с Github
  requirement: |
    Пользователь с аккаунтом GitHub должен иметь возможность войти в систему через OAuth без ввода логина и пароля на Codebattle
  prerequisites:
    GitHub-аккаунт пользователя существует и не привязан к другому профилю Codebattle
  test-data: |
    Нет
  steps:
    1. Нажать на кнопку "Sign up with Github"
    2. Перенаправление на страницу авторизации GitHub
    3. Вводим логин и пароль от Github
    4. Подтверждаем разрешения для Codebattle
  expected-result: |
    - Пользователь успешно авторизован в Codebattle
    - Перенаправление на главную страницу или в профиль
    - В профиле отображается привязанный GitHub-аккаунт

- summary: |
    Проверка успешного входа через через OAuth-интеграцию с Discord
  requirement: |
    Пользователь с аккаунтом Discord должен иметь возможность войти в систему через OAuth без ввода логина и пароля на Codebattle
  prerequisites:
    Discord-аккаунт пользователя существует и не привязан к другому профилю Codebattle
  test-data: |
    Нет
  steps:
    1. Нажать на кнопку "Sign up with Discord"
    2. Перенаправление на страницу авторизации Discord
    3. Вводим логин и пароль от Discord
    4. Подтверждаем разрешения для Codebattle
  expected-result: |
    - Пользователь успешно авторизован в Codebattle
    - Происходит перенаправление на главную страницу или в профиль
    - В профиле отображается привязанный Discord-аккаунт

- summary: |
    Проверка успешного входа в существующий аккаунт через почту и пароль
  requirement: |
    При вводе валидных данных в форме входа пользователь должен войти в свой аккаунт
  prerequisites:
    Нет
  test-data: |
    Email = testuser@example.com, Password = admin123.
  steps:
    1. Ввести email и пароль
    2. Нажать кнопку Submit
  expected-result: |
    Пользователь авторизован и перенаправлен на главную страницу

- summary: |
    Проверка возможности участия в игре в гостевом режиме без авторизации
  requirement: |
    Система должна предоставлять возможность участия в пробном сражении без регистрации и авторизации
  prerequisites:
    Пользователь не авторизован
  test-data: |
    Нет
  steps:
    1. Нажать на кнопку "Try simple battle"
    2. Дождаться загрузки игровой сессии
    3. В левой панели редактора кода ввести любой текст
    4. Нажать кнопку "Run"
  expected-result: |
    Пользователь перенаправлен на страницу с игрой, поле для ввода кода доступно для редактирования

- summary: |
    Проверка создания кастомной игры с пользовательскими настройками
  requirement: |
    Авторизованный пользователь должен иметь возможность создать игру с указанием уровня сложности, типа игры, контроля времени, конкретной задачи, тегов
  prerequisites:
    Нет
  test-data: |
    - Level = easy
    - Game type = With a bot
    - Time control = 8 min
    - Task = pizza_volume
    - Tags = math
  steps:
    1. Нажать на кнопку "Create a game"
    2. Выставить фильтры в соответствии с тестовыми данными
    3. Нажать кнопку "Create battle"
    4. Дождаться загрузки игровой сессии
  expected-result: |
    Происходит перенаправление на страницу с новой игрой, игра соответствует выбранным фильтрам, противником выступает бот

- summary: |
    Проверка создания игры с приглашением другого пользователя и совместным участием
  requirement: |
    Система должна позволять создавать игру, отправлять уведомление приглашённому пользователю и обеспечивать совместный доступ к игровой сессии
  prerequisites:
    Пользователь 1:
    - Авторизован через GitHub
    Пользователь 2:
    - Имеет валидный аккаунт (testuser@example.com/admin123.)
  test-data: |
    - Level = elementary
    - Game type = With a friend
    - Time control = 8 min
    - Task = rect_area
    - Tags = math
  steps:
    1. [Пользователь 2] Авторизоваться через email и password:
        - Ввести testuser@example.com в поле email
        - Ввести admin123. в поле Password
        - Нажать кнопку Submit
    2. [Пользователь 2] Создать игру:
        - Нажать на кнопку "Create a game"
        - Установить параметры из test-data
        - Нажать на кнопку "Create battle"
    3. [Пользователь 1] Проверить уведомление:
        - Убедиться в появлении badge-уведомления (+1)
        - Нажать на иконку уведомлений
    4. [Пользователь 1] Принять приглашение:
        - В списке выбрать приглашение от Пользователя 2
        - Нажать кнопку "Accept"
    5. Дождаться синхронизации и загрузки игровой сессии у обоих пользователей
  expected-result: |
    - Открывается один и тот же game session ID
    - Таймер показывает 8:00
    - Загружена задача "rect_area"
    - Доступен чат
    - Уведомление помечается как прочитанное

- summary: |
    Проверка полного цикла успешного создания турнира и участия в нём
  requirement: |
    Система должна предоставлять возможность:
        - Создавать турниры с настройками по умолчанию
        - Присоединяться к созданному турниру
        - Запускать турнир после формирования лобби
        - Обеспечивать игровой процесс
  prerequisites:
    Нет
  test-data: |
    Настройки по умолчанию
  steps:
    1. Перейти во вкладку "Tournaments"
    2. Нажать на текстовую ссылку "You may want to create one"
    3. В блоке "Create a new tournament":
       - Проверить автоматически сгенерированное название
       - Оставить настройки по умолчанию
       - Нажать кнопку "Create"
    4. В лобби турнира:
       - Нажать "Join" для участия
       - Нажать "Start", когда появится возможность
       - Подтвердить запуск в диалоговом окне ("Confirm")
    5. В окне ожидания:
       - Проверить отсчёт таймера
       - Нажать "Open" или дождаться автоматического старта
    6. Дождаться загрузки игровой сессии
  expected-result: |
    - Чат лобби доступен для сообщений
    - Таймер обратного отсчёта работает корректно
    - Открывается игровой интерфейс
    - Доступны все функциональные элементы (редактор кода, кнопка отправки решений)

- summary: |
    Проверка корректного отображения и обновления списка активных игр в лобби
  requirement: |
    Система должна отображать список всех доступных игр, обновлять информацию в реальном времени, сортировать игры по сложности (от легкой к сложной)
  prerequisites: |
    Нет
  test-data: |
    Нет
  steps:
    1. Во владке "Lobby" проверить наличие списка активных игр
    2. Проверить сортировку:
       - Убедиться, что игры с уровнем Easy находятся выше Medium
       - Medium находятся выше Hard
    3. Проверить обновление в реальном времени:
       - Запомнить количество игр и состояние одной из них
       - Подождать 30 секунд
       - Проверить изменения в списке
  expected-result: |
    - Все активные игры видны в лобби
    - Для каждой игры отображается уровень сложности, никнеймы участников, кнопки действий (присоединиться/показать), статус (ожидание/в процессе)
    - Игры упорядочены по сложности: Easy → Medium → Hard
    - Новые игры появляются автоматически
    - Изменения статусов отображаются без перезагрузки
    - Количество участников обновляется в реальном времени

- summary: |
    Проверка функционала наблюдения за активной игровой сессией других пользователей
  requirement: |
    Система должна предоставлять возможность:
    1. Просматривать активные игры других пользователей
    2. Отображать игровой процесс в реальном времени
    3. Обеспечивать функционал чата для наблюдателей
  prerequisites: |
    В списке активных игр есть минимум одна активная сессия
  test-data: |
    Нет
  steps:
    1. В разделе "Lobby" найти игру со статусом "Playing"
    2. Нажать кнопку "Show" в строке выбранной игры
    3. Дождаться полной загрузки страницы
    4. Проверить элементы интерфейса:
       - Во вкладке "General" нажать на поле для ввода текста
       - Ввести тестовое сообщение
       - Нажать на кнопку "Send"
  expected-result: |
    - Виден код обоих участников (read-only)
    - Отображается реальное состояние игры
    - Таймер обновляется в реальном времени
    - Видна текущая задача
    - Чат доступен для ввода сообщений

- summary: |
    Проверка возможности изменения и сохранения личной информации о пользователе
  requirement: |
    Пользователь должен иметь возможность менять и сохранять данные о себе в настройках
  prerequisites: |
    Нет
  test-data: |
    Nickname = Lalala
    Your weapon = Go
  steps:
    1. Нажать на свою аватарку
    2. Перейти в настройки через кнопку "Settings"
    3. Изменить данные из test-data
    4. Нажать кнопку "Save"
    5. Перезагрузить страницу
  expected-result: |
    Данные изменяются на желаемые и сохраняются даже после перезагрузки страницы
